{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\cacma\\\\Downloads\\\\foodie-express-1\\\\foodie-express-v2\\\\foodie-express\\\\foodie-express-frontend\\\\src\\\\CartContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// src/CartContext.js\nimport React, { createContext, useContext, useState, useEffect } from \"react\";\nimport { toast } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CartContext = /*#__PURE__*/createContext(null);\nexport const CartProvider = ({\n  children\n}) => {\n  _s();\n  const [cart, setCart] = useState(() => {\n    try {\n      const s = localStorage.getItem(\"cart\");\n      const parsed = s ? JSON.parse(s) : [];\n      return Array.isArray(parsed) ? parsed : [];\n    } catch {\n      return [];\n    }\n  });\n  useEffect(() => {\n    localStorage.setItem(\"cart\", JSON.stringify(cart));\n  }, [cart]);\n\n  // ✅ helper lấy tên an toàn\n  const safeName = item => (item === null || item === void 0 ? void 0 : item.name) || (item === null || item === void 0 ? void 0 : item.title) || (item === null || item === void 0 ? void 0 : item.productName) || \"món ăn\";\n\n  // ✅ Thêm món vào giỏ (an toàn, không crash)\n  const addToCart = (food, quantity = 1) => {\n    if (!food || typeof food !== \"object\") {\n      toast.error(\"Món ăn không hợp lệ (thiếu dữ liệu).\");\n      return;\n    }\n    const id = food._id || food.id;\n    if (!id) {\n      toast.error(\"Món ăn không có ID (_id).\");\n      return;\n    }\n    const q = Math.max(1, parseInt(quantity, 10) || 1);\n    let message = \"\";\n    setCart(prev => {\n      const existing = prev.find(p => ((p === null || p === void 0 ? void 0 : p._id) || (p === null || p === void 0 ? void 0 : p.id)) === id);\n      if (existing) {\n        const newQty = (existing.quantity || 1) + q;\n        message = `Tăng số lượng ${safeName(food)} lên ${newQty}`;\n        return prev.map(p => ((p === null || p === void 0 ? void 0 : p._id) || (p === null || p === void 0 ? void 0 : p.id)) === id ? {\n          ...p,\n          quantity: newQty\n        } : p);\n      } else {\n        message = `Đã thêm ${safeName(food)} x${q} vào giỏ`;\n        return [...prev, {\n          ...food,\n          _id: id,\n          quantity: q\n        }];\n      }\n    });\n    setTimeout(() => toast.info(message), 50);\n  };\n  const increaseQuantity = id => {\n    setCart(prev => prev.map(p => ((p === null || p === void 0 ? void 0 : p._id) || (p === null || p === void 0 ? void 0 : p.id)) === id ? {\n      ...p,\n      quantity: (p.quantity || 1) + 1\n    } : p));\n  };\n  const decreaseQuantity = id => {\n    setCart(prev => prev.map(p => ((p === null || p === void 0 ? void 0 : p._id) || (p === null || p === void 0 ? void 0 : p.id)) === id && (p.quantity || 1) > 1 ? {\n      ...p,\n      quantity: (p.quantity || 1) - 1\n    } : p).filter(Boolean));\n  };\n  const updateQuantity = (id, newQuantity) => {\n    const quantity = Math.max(1, parseInt(newQuantity, 10) || 1);\n    setCart(prev => prev.map(p => ((p === null || p === void 0 ? void 0 : p._id) || (p === null || p === void 0 ? void 0 : p.id)) === id ? {\n      ...p,\n      quantity\n    } : p));\n  };\n  const removeFromCart = id => {\n    const removed = cart.find(p => ((p === null || p === void 0 ? void 0 : p._id) || (p === null || p === void 0 ? void 0 : p.id)) === id);\n    setCart(prev => prev.filter(p => ((p === null || p === void 0 ? void 0 : p._id) || (p === null || p === void 0 ? void 0 : p.id)) !== id));\n    if (removed) setTimeout(() => toast.warn(`Đã xóa ${safeName(removed)}`), 50);\n  };\n  const clearCart = () => {\n    setCart([]);\n    setTimeout(() => toast.info(\"Đã xóa toàn bộ giỏ hàng\"), 50);\n  };\n  const getTotalPrice = () => cart.reduce((sum, i) => sum + (Number(i === null || i === void 0 ? void 0 : i.price) || 0) * ((i === null || i === void 0 ? void 0 : i.quantity) || 1), 0);\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: {\n      cart,\n      addToCart,\n      increaseQuantity,\n      decreaseQuantity,\n      updateQuantity,\n      removeFromCart,\n      clearCart,\n      getTotalPrice\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 104,\n    columnNumber: 5\n  }, this);\n};\n_s(CartProvider, \"jQbr1idxZ1SWJWPAlEa84dkYqWU=\");\n_c = CartProvider;\nexport const useCart = () => {\n  _s2();\n  return useContext(CartContext);\n};\n_s2(useCart, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","toast","jsxDEV","_jsxDEV","CartContext","CartProvider","children","_s","cart","setCart","s","localStorage","getItem","parsed","JSON","parse","Array","isArray","setItem","stringify","safeName","item","name","title","productName","addToCart","food","quantity","error","id","_id","q","Math","max","parseInt","message","prev","existing","find","p","newQty","map","setTimeout","info","increaseQuantity","decreaseQuantity","filter","Boolean","updateQuantity","newQuantity","removeFromCart","removed","warn","clearCart","getTotalPrice","reduce","sum","i","Number","price","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useCart","_s2","$RefreshReg$"],"sources":["C:/Users/cacma/Downloads/foodie-express-1/foodie-express-v2/foodie-express/foodie-express-frontend/src/CartContext.js"],"sourcesContent":["// src/CartContext.js\r\nimport React, { createContext, useContext, useState, useEffect } from \"react\";\r\nimport { toast } from \"react-toastify\";\r\nimport \"react-toastify/dist/ReactToastify.css\";\r\n\r\nconst CartContext = createContext(null);\r\n\r\nexport const CartProvider = ({ children }) => {\r\n  const [cart, setCart] = useState(() => {\r\n    try {\r\n      const s = localStorage.getItem(\"cart\");\r\n      const parsed = s ? JSON.parse(s) : [];\r\n      return Array.isArray(parsed) ? parsed : [];\r\n    } catch {\r\n      return [];\r\n    }\r\n  });\r\n\r\n  useEffect(() => {\r\n    localStorage.setItem(\"cart\", JSON.stringify(cart));\r\n  }, [cart]);\r\n\r\n  // ✅ helper lấy tên an toàn\r\n  const safeName = (item) => item?.name || item?.title || item?.productName || \"món ăn\";\r\n\r\n  // ✅ Thêm món vào giỏ (an toàn, không crash)\r\n  const addToCart = (food, quantity = 1) => {\r\n    if (!food || typeof food !== \"object\") {\r\n      toast.error(\"Món ăn không hợp lệ (thiếu dữ liệu).\");\r\n      return;\r\n    }\r\n\r\n    const id = food._id || food.id;\r\n    if (!id) {\r\n      toast.error(\"Món ăn không có ID (_id).\");\r\n      return;\r\n    }\r\n\r\n    const q = Math.max(1, parseInt(quantity, 10) || 1);\r\n\r\n    let message = \"\";\r\n    setCart((prev) => {\r\n      const existing = prev.find((p) => (p?._id || p?.id) === id);\r\n\r\n      if (existing) {\r\n        const newQty = (existing.quantity || 1) + q;\r\n        message = `Tăng số lượng ${safeName(food)} lên ${newQty}`;\r\n        return prev.map((p) =>\r\n          (p?._id || p?.id) === id ? { ...p, quantity: newQty } : p\r\n        );\r\n      } else {\r\n        message = `Đã thêm ${safeName(food)} x${q} vào giỏ`;\r\n        return [...prev, { ...food, _id: id, quantity: q }];\r\n      }\r\n    });\r\n\r\n    setTimeout(() => toast.info(message), 50);\r\n  };\r\n\r\n  const increaseQuantity = (id) => {\r\n    setCart((prev) =>\r\n      prev.map((p) =>\r\n        (p?._id || p?.id) === id ? { ...p, quantity: (p.quantity || 1) + 1 } : p\r\n      )\r\n    );\r\n  };\r\n\r\n  const decreaseQuantity = (id) => {\r\n    setCart((prev) =>\r\n      prev\r\n        .map((p) =>\r\n          (p?._id || p?.id) === id && (p.quantity || 1) > 1\r\n            ? { ...p, quantity: (p.quantity || 1) - 1 }\r\n            : p\r\n        )\r\n        .filter(Boolean)\r\n    );\r\n  };\r\n\r\n  const updateQuantity = (id, newQuantity) => {\r\n    const quantity = Math.max(1, parseInt(newQuantity, 10) || 1);\r\n    setCart((prev) =>\r\n      prev.map((p) =>\r\n        (p?._id || p?.id) === id ? { ...p, quantity } : p\r\n      )\r\n    );\r\n  };\r\n\r\n  const removeFromCart = (id) => {\r\n    const removed = cart.find((p) => (p?._id || p?.id) === id);\r\n    setCart((prev) => prev.filter((p) => (p?._id || p?.id) !== id));\r\n    if (removed) setTimeout(() => toast.warn(`Đã xóa ${safeName(removed)}`), 50);\r\n  };\r\n\r\n  const clearCart = () => {\r\n    setCart([]);\r\n    setTimeout(() => toast.info(\"Đã xóa toàn bộ giỏ hàng\"), 50);\r\n  };\r\n\r\n  const getTotalPrice = () =>\r\n    cart.reduce((sum, i) => sum + (Number(i?.price) || 0) * (i?.quantity || 1), 0);\r\n\r\n  return (\r\n    <CartContext.Provider\r\n      value={{\r\n        cart,\r\n        addToCart,\r\n        increaseQuantity,\r\n        decreaseQuantity,\r\n        updateQuantity,\r\n        removeFromCart,\r\n        clearCart,\r\n        getTotalPrice,\r\n      }}\r\n    >\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useCart = () => useContext(CartContext);\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}