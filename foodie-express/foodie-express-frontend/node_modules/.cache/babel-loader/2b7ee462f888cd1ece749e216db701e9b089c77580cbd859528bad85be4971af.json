{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\cacma\\\\Downloads\\\\foodie-express-1\\\\foodie-express-v2\\\\foodie-express\\\\foodie-express-frontend\\\\src\\\\AuthContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\n// src/AuthContext.js\nimport React, { createContext, useContext, useEffect, useMemo, useState } from \"react\";\nimport { loginUser, registerUser, socialLogin as socialLoginApi } from \"./api\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst AuthContext = /*#__PURE__*/createContext(null);\nexport const useAuth = () => {\n  _s();\n  return useContext(AuthContext);\n};\n_s(useAuth, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport default function AuthProvider({\n  children\n}) {\n  _s2();\n  const [user, setUser] = useState(null);\n  useEffect(() => {\n    try {\n      const u = localStorage.getItem(\"user\");\n      if (u) setUser(JSON.parse(u));\n    } catch {\n      // ignore\n    }\n  }, []);\n  const saveSession = data => {\n    if (data !== null && data !== void 0 && data.token) localStorage.setItem(\"token\", data.token);\n    if (data !== null && data !== void 0 && data.user) {\n      localStorage.setItem(\"user\", JSON.stringify(data.user));\n      setUser(data.user);\n    }\n  };\n  const login = async (email, password, cb) => {\n    try {\n      const data = await loginUser({\n        email,\n        password\n      });\n      saveSession(data);\n      cb === null || cb === void 0 ? void 0 : cb();\n    } catch (err) {\n      console.error(err);\n      alert(err.message || \"Đăng nhập thất bại\");\n    }\n  };\n  const register = async (name, email, password, cb) => {\n    try {\n      const data = await registerUser({\n        name,\n        email,\n        password\n      });\n      saveSession(data);\n      cb === null || cb === void 0 ? void 0 : cb();\n    } catch (err) {\n      console.error(err);\n      alert(err.message || \"Đăng ký thất bại\");\n    }\n  };\n  const socialLogin = async (idToken, cb) => {\n    try {\n      const data = await socialLoginApi(idToken);\n      saveSession(data);\n      cb === null || cb === void 0 ? void 0 : cb();\n    } catch (err) {\n      console.error(err);\n      alert(err.message || \"Đăng nhập Google thất bại\");\n    }\n  };\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"user\");\n    setUser(null);\n    window.location.href = \"/\";\n  };\n  const value = useMemo(() => ({\n    user,\n    login,\n    register,\n    socialLogin,\n    logout\n  }), [user]);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: value,\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 70,\n    columnNumber: 10\n  }, this);\n}\n_s2(AuthProvider, \"O+oz1ToS9aE4CkD7AzxMsbJjB2g=\");\n_c = AuthProvider;\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["React","createContext","useContext","useEffect","useMemo","useState","loginUser","registerUser","socialLogin","socialLoginApi","jsxDEV","_jsxDEV","AuthContext","useAuth","_s","AuthProvider","children","_s2","user","setUser","u","localStorage","getItem","JSON","parse","saveSession","data","token","setItem","stringify","login","email","password","cb","err","console","error","alert","message","register","name","idToken","logout","removeItem","window","location","href","value","Provider","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Users/cacma/Downloads/foodie-express-1/foodie-express-v2/foodie-express/foodie-express-frontend/src/AuthContext.js"],"sourcesContent":["// src/AuthContext.js\nimport React, { createContext, useContext, useEffect, useMemo, useState } from \"react\";\nimport { loginUser, registerUser, socialLogin as socialLoginApi } from \"./api\";\n\nconst AuthContext = createContext(null);\nexport const useAuth = () => useContext(AuthContext);\n\nexport default function AuthProvider({ children }) {\n  const [user, setUser] = useState(null);\n\n  useEffect(() => {\n    try {\n      const u = localStorage.getItem(\"user\");\n      if (u) setUser(JSON.parse(u));\n    } catch {\n      // ignore\n    }\n  }, []);\n\n  const saveSession = (data) => {\n    if (data?.token) localStorage.setItem(\"token\", data.token);\n    if (data?.user) {\n      localStorage.setItem(\"user\", JSON.stringify(data.user));\n      setUser(data.user);\n    }\n  };\n\n  const login = async (email, password, cb) => {\n    try {\n      const data = await loginUser({ email, password });\n      saveSession(data);\n      cb?.();\n    } catch (err) {\n      console.error(err);\n      alert(err.message || \"Đăng nhập thất bại\");\n    }\n  };\n\n  const register = async (name, email, password, cb) => {\n    try {\n      const data = await registerUser({ name, email, password });\n      saveSession(data);\n      cb?.();\n    } catch (err) {\n      console.error(err);\n      alert(err.message || \"Đăng ký thất bại\");\n    }\n  };\n\n  const socialLogin = async (idToken, cb) => {\n    try {\n      const data = await socialLoginApi(idToken);\n      saveSession(data);\n      cb?.();\n    } catch (err) {\n      console.error(err);\n      alert(err.message || \"Đăng nhập Google thất bại\");\n    }\n  };\n\n  const logout = () => {\n    localStorage.removeItem(\"token\");\n    localStorage.removeItem(\"user\");\n    setUser(null);\n    window.location.href = \"/\";\n  };\n\n  const value = useMemo(() => ({ user, login, register, socialLogin, logout }), [user]);\n\n  return <AuthContext.Provider value={value}>{children}</AuthContext.Provider>;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}