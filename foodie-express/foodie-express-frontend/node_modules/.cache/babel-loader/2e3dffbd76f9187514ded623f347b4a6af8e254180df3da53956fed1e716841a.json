{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\cacma\\\\Downloads\\\\foodie-express-1\\\\foodie-express-v2\\\\foodie-express\\\\foodie-express-frontend\\\\src\\\\ChatWidget.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport { useAuth } from \"./AuthContext\";\nimport { useSocket } from './SocketContext';\nimport { getMyConversation, getConversationMessages, markConversationRead } from './api';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst LS_KEY = \"fe_chat_demo_v1\";\nfunction safeParse(raw, fallback) {\n  try {\n    const v = JSON.parse(raw);\n    return v !== null && v !== void 0 ? v : fallback;\n  } catch {\n    return fallback;\n  }\n}\nfunction nowHHMM() {\n  const d = new Date();\n  const hh = String(d.getHours()).padStart(2, \"0\");\n  const mm = String(d.getMinutes()).padStart(2, \"0\");\n  return `${hh}:${mm}`;\n}\nexport default function ChatWidget() {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const {\n    socket,\n    connected\n  } = useSocket();\n  const me = useMemo(() => {\n    if (user !== null && user !== void 0 && user.email) return user.email;\n    return \"guest\";\n  }, [user]);\n  const [open, setOpen] = useState(false);\n  const [text, setText] = useState(\"\");\n  const [conversationId, setConversationId] = useState(null);\n  const [messages, setMessages] = useState(() => safeParse(localStorage.getItem(LS_KEY), []));\n  const listRef = useRef(null);\n  useEffect(() => {\n    // Guest uses localStorage\n    if (!user) localStorage.setItem(LS_KEY, JSON.stringify(messages));\n  }, [messages, user]);\n\n  // Load conversation when logged in\n  useEffect(() => {\n    let mounted = true;\n    (async () => {\n      if (!user) return;\n      try {\n        const conv = await getMyConversation();\n        if (!mounted) return;\n        setConversationId(conv._id);\n        const data = await getConversationMessages(conv._id);\n        if (!mounted) return;\n        setMessages((data.messages || []).map(m => ({\n          from: m.senderRole,\n          content: m.text,\n          at: new Date(m.createdAt).toLocaleTimeString([], {\n            hour: '2-digit',\n            minute: '2-digit'\n          }),\n          role: m.senderRole === 'customer' ? 'user' : 'bot'\n        })));\n      } catch (e) {\n        console.error(e);\n      }\n    })();\n    return () => {\n      mounted = false;\n    };\n  }, [user]);\n\n  // Join socket room + realtime messages\n  useEffect(() => {\n    if (!socket || !connected || !conversationId) return;\n    socket.emit('conv:join', conversationId);\n    const onMessage = msg => {\n      if (String(msg.conversationId) !== String(conversationId)) return;\n      setMessages(prev => [...prev, {\n        from: msg.senderRole,\n        content: msg.text,\n        at: new Date(msg.createdAt).toLocaleTimeString([], {\n          hour: '2-digit',\n          minute: '2-digit'\n        }),\n        role: msg.senderRole === 'customer' ? 'user' : 'bot'\n      }]);\n    };\n    socket.on('chat:message', onMessage);\n    return () => {\n      socket.off('chat:message', onMessage);\n    };\n  }, [socket, connected, conversationId]);\n  useEffect(() => {\n    if (!open) return;\n    const t = setTimeout(() => {\n      if (listRef.current) listRef.current.scrollTop = listRef.current.scrollHeight;\n    }, 0);\n    return () => clearTimeout(t);\n  }, [open, messages]);\n  const send = async () => {\n    const content = text.trim();\n    if (!content) return;\n    setText(\"\");\n\n    // If not logged in => fallback demo\n    if (!user || !socket) {\n      const msg = {\n        from: me,\n        content,\n        at: nowHHMM(),\n        role: \"user\"\n      };\n      setMessages(prev => [...prev, msg]);\n      const reply = {\n        from: \"FoodieExpress\",\n        role: \"bot\",\n        at: nowHHMM(),\n        content: \"D·∫° shop ƒë√£ nh·∫≠n tin! (demo) B·∫°n c√≥ th·ªÉ ghi: ƒë·ªãa ch·ªâ, ghi ch√∫ m√≥n, ho·∫∑c h·ªèi khuy·∫øn m√£i h√¥m nay ·∫° üòä\"\n      };\n      setTimeout(() => setMessages(prev => [...prev, reply]), 450);\n      return;\n    }\n    socket.emit('chat:send', {\n      conversationId,\n      text: content\n    }, ack => {\n      if (ack !== null && ack !== void 0 && ack.ok && ack.conversationId && !conversationId) {\n        setConversationId(ack.conversationId);\n      }\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"button\", {\n      className: \"fe-chatFab\",\n      onClick: () => setOpen(v => !v),\n      title: \"Chat v\\u1EDBi c\\u1EEDa h\\xE0ng (demo)\",\n      children: \"\\uD83D\\uDCAC\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 7\n    }, this), open ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"fe-chatPanel\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fe-chatHeader\",\n        children: [/*#__PURE__*/_jsxDEV(\"b\", {\n          children: \"\\uD83D\\uDCAC Chat c\\u1EEDa h\\xE0ng (demo)\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 148,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"fe-pill\",\n          onClick: () => setOpen(false),\n          children: \"\\u0110\\xF3ng\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 149,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        ref: listRef,\n        className: \"fe-chatList\",\n        children: [messages.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n          style: {\n            color: \"#667085\",\n            fontSize: 13\n          },\n          children: \"Ch\\u01B0a c\\xF3 tin nh\\u1EAFn. G\\u1EEDi th\\u1EED \\\"Xin m\\xE3 gi\\u1EA3m gi\\xE1\\\" \\uD83D\\uDE04\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 156,\n          columnNumber: 15\n        }, this) : null, messages.map((m, idx) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: `fe-chatBubble ${m.role === \"user\" ? \"me\" : \"bot\"}`,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            style: {\n              fontSize: 12,\n              opacity: 0.75,\n              marginBottom: 2\n            },\n            children: [m.role === \"user\" ? \"B·∫°n\" : \"Shop\", \" \\u2022 \", m.at]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 163,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            children: m.content\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 166,\n            columnNumber: 17\n          }, this)]\n        }, idx, true, {\n          fileName: _jsxFileName,\n          lineNumber: 159,\n          columnNumber: 15\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"fe-chatComposer\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          className: \"fe-input\",\n          placeholder: \"Nh\\u1EADp tin nh\\u1EAFn...\",\n          value: text,\n          onChange: e => setText(e.target.value),\n          onKeyDown: e => {\n            if (e.key === \"Enter\") send();\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 172,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"fe-pill primary\",\n          onClick: send,\n          children: \"G\\u1EEDi\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 9\n    }, this) : null]\n  }, void 0, true);\n}\n_s(ChatWidget, \"EfdJbNtxj1fHbxqeyb5DbO0oAH8=\", false, function () {\n  return [useAuth, useSocket];\n});\n_c = ChatWidget;\nvar _c;\n$RefreshReg$(_c, \"ChatWidget\");","map":{"version":3,"names":["React","useEffect","useMemo","useRef","useState","useAuth","useSocket","getMyConversation","getConversationMessages","markConversationRead","jsxDEV","_jsxDEV","Fragment","_Fragment","LS_KEY","safeParse","raw","fallback","v","JSON","parse","nowHHMM","d","Date","hh","String","getHours","padStart","mm","getMinutes","ChatWidget","_s","user","socket","connected","me","email","open","setOpen","text","setText","conversationId","setConversationId","messages","setMessages","localStorage","getItem","listRef","setItem","stringify","mounted","conv","_id","data","map","m","from","senderRole","content","at","createdAt","toLocaleTimeString","hour","minute","role","e","console","error","emit","onMessage","msg","prev","on","off","t","setTimeout","current","scrollTop","scrollHeight","clearTimeout","send","trim","reply","ack","ok","children","className","onClick","title","fileName","_jsxFileName","lineNumber","columnNumber","ref","length","style","color","fontSize","idx","opacity","marginBottom","placeholder","value","onChange","target","onKeyDown","key","_c","$RefreshReg$"],"sources":["C:/Users/cacma/Downloads/foodie-express-1/foodie-express-v2/foodie-express/foodie-express-frontend/src/ChatWidget.js"],"sourcesContent":["import React, { useEffect, useMemo, useRef, useState } from \"react\";\nimport { useAuth } from \"./AuthContext\";\nimport { useSocket } from './SocketContext';\nimport { getMyConversation, getConversationMessages, markConversationRead } from './api';\n\nconst LS_KEY = \"fe_chat_demo_v1\";\n\nfunction safeParse(raw, fallback) {\n  try {\n    const v = JSON.parse(raw);\n    return v ?? fallback;\n  } catch {\n    return fallback;\n  }\n}\n\nfunction nowHHMM() {\n  const d = new Date();\n  const hh = String(d.getHours()).padStart(2, \"0\");\n  const mm = String(d.getMinutes()).padStart(2, \"0\");\n  return `${hh}:${mm}`;\n}\n\nexport default function ChatWidget() {\n  const { user } = useAuth();\n  const { socket, connected } = useSocket();\n  const me = useMemo(() => {\n    if (user?.email) return user.email;\n    return \"guest\";\n  }, [user]);\n\n  const [open, setOpen] = useState(false);\n  const [text, setText] = useState(\"\");\n  const [conversationId, setConversationId] = useState(null);\n  const [messages, setMessages] = useState(() => safeParse(localStorage.getItem(LS_KEY), []));\n\n  const listRef = useRef(null);\n\n  useEffect(() => {\n    // Guest uses localStorage\n    if (!user) localStorage.setItem(LS_KEY, JSON.stringify(messages));\n  }, [messages, user]);\n\n  // Load conversation when logged in\n  useEffect(() => {\n    let mounted = true;\n    (async () => {\n      if (!user) return;\n      try {\n        const conv = await getMyConversation();\n        if (!mounted) return;\n        setConversationId(conv._id);\n\n        const data = await getConversationMessages(conv._id);\n        if (!mounted) return;\n        setMessages(\n          (data.messages || []).map((m) => ({\n            from: m.senderRole,\n            content: m.text,\n            at: new Date(m.createdAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),\n            role: m.senderRole === 'customer' ? 'user' : 'bot',\n          }))\n        );\n      } catch (e) {\n        console.error(e);\n      }\n    })();\n    return () => {\n      mounted = false;\n    };\n  }, [user]);\n\n  // Join socket room + realtime messages\n  useEffect(() => {\n    if (!socket || !connected || !conversationId) return;\n    socket.emit('conv:join', conversationId);\n\n    const onMessage = (msg) => {\n      if (String(msg.conversationId) !== String(conversationId)) return;\n      setMessages((prev) => [\n        ...prev,\n        {\n          from: msg.senderRole,\n          content: msg.text,\n          at: new Date(msg.createdAt).toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' }),\n          role: msg.senderRole === 'customer' ? 'user' : 'bot',\n        },\n      ]);\n    };\n    socket.on('chat:message', onMessage);\n    return () => {\n      socket.off('chat:message', onMessage);\n    };\n  }, [socket, connected, conversationId]);\n\n  useEffect(() => {\n    if (!open) return;\n    const t = setTimeout(() => {\n      if (listRef.current) listRef.current.scrollTop = listRef.current.scrollHeight;\n    }, 0);\n    return () => clearTimeout(t);\n  }, [open, messages]);\n\n  const send = async () => {\n    const content = text.trim();\n    if (!content) return;\n    setText(\"\");\n\n    // If not logged in => fallback demo\n    if (!user || !socket) {\n      const msg = { from: me, content, at: nowHHMM(), role: \"user\" };\n      setMessages((prev) => [...prev, msg]);\n      const reply = {\n        from: \"FoodieExpress\",\n        role: \"bot\",\n        at: nowHHMM(),\n        content:\n          \"D·∫° shop ƒë√£ nh·∫≠n tin! (demo) B·∫°n c√≥ th·ªÉ ghi: ƒë·ªãa ch·ªâ, ghi ch√∫ m√≥n, ho·∫∑c h·ªèi khuy·∫øn m√£i h√¥m nay ·∫° üòä\",\n      };\n      setTimeout(() => setMessages((prev) => [...prev, reply]), 450);\n      return;\n    }\n\n    socket.emit(\n      'chat:send',\n      { conversationId, text: content },\n      (ack) => {\n        if (ack?.ok && ack.conversationId && !conversationId) {\n          setConversationId(ack.conversationId);\n        }\n      }\n    );\n  };\n\n  return (\n    <>\n      <button\n        className=\"fe-chatFab\"\n        onClick={() => setOpen((v) => !v)}\n        title=\"Chat v·ªõi c·ª≠a h√†ng (demo)\"\n      >\n        üí¨\n      </button>\n\n      {open ? (\n        <div className=\"fe-chatPanel\">\n          <div className=\"fe-chatHeader\">\n            <b>üí¨ Chat c·ª≠a h√†ng (demo)</b>\n            <button className=\"fe-pill\" onClick={() => setOpen(false)}>\n              ƒê√≥ng\n            </button>\n          </div>\n\n          <div ref={listRef} className=\"fe-chatList\">\n            {messages.length === 0 ? (\n              <div style={{ color: \"#667085\", fontSize: 13 }}>Ch∆∞a c√≥ tin nh·∫Øn. G·ª≠i th·ª≠ \"Xin m√£ gi·∫£m gi√°\" üòÑ</div>\n            ) : null}\n            {messages.map((m, idx) => (\n              <div\n                key={idx}\n                className={`fe-chatBubble ${m.role === \"user\" ? \"me\" : \"bot\"}`}\n              >\n                <div style={{ fontSize: 12, opacity: 0.75, marginBottom: 2 }}>\n                  {m.role === \"user\" ? \"B·∫°n\" : \"Shop\"} ‚Ä¢ {m.at}\n                </div>\n                <div>{m.content}</div>\n              </div>\n            ))}\n          </div>\n\n          <div className=\"fe-chatComposer\">\n            <input\n              className=\"fe-input\"\n              placeholder=\"Nh·∫≠p tin nh·∫Øn...\"\n              value={text}\n              onChange={(e) => setText(e.target.value)}\n              onKeyDown={(e) => {\n                if (e.key === \"Enter\") send();\n              }}\n            />\n            <button className=\"fe-pill primary\" onClick={send}>\n              G·ª≠i\n            </button>\n          </div>\n        </div>\n      ) : null}\n    </>\n  );\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}